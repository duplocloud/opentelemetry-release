apiVersion: grizzly.grafana.com/v1alpha1
kind: Dashboard
metadata:
    folder: Integration-GCP-Monitoring
    name: uptime-checks-overview
spec:
    annotations:
        list:
            - builtIn: 1
              datasource:
                type: grafana
                uid: -- Grafana --
              enable: true
              hide: true
              iconColor: rgba(0, 211, 255, 1)
              name: Annotations & Alerts
              type: dashboard
    description: Project-wise overview of all uptime checks with location, status, latency, and SSL certificate expiry
    editable: true
    fiscalYearStartMonth: 0
    graphTooltip: 0
    links: []
    panels:
        - collapsed: false
          gridPos:
            h: 1
            w: 24
            x: 0
            "y": 0
          id: 2
          panels: []
          repeat: project
          title: $project
          type: row
        - datasource:
            type: stackdriver
            uid: $datasource
          description: Project-wise uptime checks with location, status, latency, and SSL certificate expiry
          fieldConfig:
            defaults:
                color:
                    mode: thresholds
                custom:
                    align: center
                    cellOptions:
                        type: auto
                    filterable: false
                    inspect: false
                mappings: []
                noValue: '-'
                thresholds:
                    mode: absolute
                    steps:
                        - color: green
            overrides:
                - matcher:
                    id: byName
                    options: Status
                  properties:
                    - id: mappings
                      value:
                        - options:
                            "0":
                                color: red
                                text: Failed
                          type: value
                        - options:
                            "1":
                                color: green
                                text: Passed
                          type: value
                    - id: custom.cellOptions
                      value:
                        type: auto
                    - id: color
                      value:
                        fixedColor: green
                        mode: palette-classic-by-name
                    - id: thresholds
                      value:
                        mode: absolute
                        steps:
                            - color: red
                            - color: green
                              value: 1
                - matcher:
                    id: byName
                    options: Latency
                  properties:
                    - id: unit
                      value: ms
                    - id: decimals
                      value: 2
                    - id: custom.cellOptions
                      value:
                        type: auto
                    - id: thresholds
                      value:
                        mode: absolute
                        steps:
                            - color: green
                            - color: yellow
                              value: 500
                            - color: red
                              value: 1000
                    - id: color
                      value:
                        fixedColor: blue
                        mode: fixed
                - matcher:
                    id: byName
                    options: SSL Expiry
                  properties:
                    - id: unit
                      value: d
                    - id: custom.cellOptions
                      value:
                        type: auto
                        wrapText: false
                    - id: thresholds
                      value:
                        mode: absolute
                        steps:
                            - color: red
                            - color: green
                              value: 14
                    - id: decimals
                      value: 0
                    - id: color
                      value:
                        fixedColor: red
                        mode: shades
                - matcher:
                    id: byName
                    options: Check ID
                  properties:
                    - id: custom.filterable
                      value: true
                    - id: custom.width
                      value: 280
                    - id: links
                      value:
                        - targetBlank: true
                          title: Open Uptime Check Dashboard
                          url: /d/0a32a8df-662a-41f5-ad78-357701d529b6/uptime-checks?var-project=${project}&var-check_id=${__data.fields["Check ID"]}&var-location=$__all
                - matcher:
                    id: byName
                    options: Location
                  properties:
                    - id: custom.filterable
                      value: true
                - matcher:
                    id: byName
                    options: Check Resource Type
                  properties:
                    - id: custom.filterable
                      value: true
                - matcher:
                    id: byName
                    options: Check Resource ID
                  properties:
                    - id: custom.filterable
                      value: true
                - matcher:
                    id: byName
                    options: Service Name
                  properties:
                    - id: custom.filterable
                      value: true
                - matcher:
                    id: byName
                    options: Host
                  properties:
                    - id: custom.filterable
                      value: true
          gridPos:
            h: 7
            w: 24
            x: 0
            "y": 1
          id: 1
          options:
            cellHeight: sm
            enablePagination: false
            footer:
                countRows: false
                fields: ""
                reducer:
                    - sum
                show: false
            frozenColumns:
                left: -1
            showHeader: true
            sortBy: []
          pluginVersion: 12.0.2+security-01
          targets:
            - datasource:
                type: stackdriver
                uid: $datasource
              hide: false
              queryType: timeSeriesList
              range: false
              refId: A
              timeSeriesList:
                alignmentPeriod: cloud-monitoring-auto
                crossSeriesReducer: REDUCE_NONE
                filters:
                    - metric.type
                    - =
                    - monitoring.googleapis.com/uptime_check/check_passed
                groupBys:
                    - resource.label.check_id
                perSeriesAligner: ALIGN_NONE
                preprocessor: none
                projectName: $project
                view: FULL
            - datasource:
                type: stackdriver
                uid: $datasource
              hide: false
              queryType: timeSeriesList
              range: false
              refId: B
              timeSeriesList:
                alignmentPeriod: cloud-monitoring-auto
                crossSeriesReducer: REDUCE_NONE
                filters:
                    - metric.type
                    - =
                    - monitoring.googleapis.com/uptime_check/request_latency
                groupBys:
                    - resource.label.check_id
                perSeriesAligner: ALIGN_NONE
                preprocessor: none
                projectName: $project
                view: FULL
            - datasource:
                type: stackdriver
                uid: $datasource
              hide: false
              queryType: timeSeriesList
              range: false
              refId: C
              timeSeriesList:
                alignmentPeriod: cloud-monitoring-auto
                crossSeriesReducer: REDUCE_NONE
                filters:
                    - metric.type
                    - =
                    - monitoring.googleapis.com/uptime_check/time_until_ssl_cert_expires
                groupBys:
                    - resource.label.check_id
                perSeriesAligner: ALIGN_NONE
                preprocessor: none
                projectName: $project
                view: FULL
          title: Uptime checks overview
          transformations:
            - id: timeSeriesTable
              options:
                A:
                    timeField: Time
                B:
                    timeField: Time
                C:
                    timeField: Time
            - id: merge
              options: {}
            - id: groupBy
              options:
                fields:
                    Latency:
                        aggregations:
                            - mean
                        operation: aggregate
                    SSL Expiry:
                        aggregations:
                            - lastNotNull
                        operation: aggregate
                    Status:
                        aggregations:
                            - mean
                        operation: aggregate
                    'Trend #A':
                        aggregations:
                            - lastNotNull
                        operation: groupby
                    'Trend #B':
                        aggregations:
                            - mean
                        operation: groupby
                    'Trend #C':
                        aggregations:
                            - lastNotNull
                        operation: groupby
                    metric.label.check_id:
                        aggregations: []
                        operation: groupby
                    metric.label.checked_resource_id:
                        aggregations: []
                        operation: groupby
                    metric.label.checker_location:
                        aggregations: []
                    resource.label.configuration_name:
                        aggregations: []
                        operation: groupby
                    resource.label.host:
                        aggregations: []
                        operation: groupby
                    resource.label.location:
                        aggregations: []
                    resource.label.project_id:
                        aggregations: []
                    resource.label.service_name:
                        aggregations: []
                        operation: groupby
                    resource.type:
                        aggregations: []
                        operation: groupby
            - id: organize
              options:
                excludeByName:
                    Time: true
                    metric.label.checker_location: false
                    resource.label.configuration_name: true
                    resource.label.location: true
                    resource.label.project_id: true
                    resource.label.revision_name: true
                includeByName: {}
                indexByName:
                    'Trend #A': 10
                    'Trend #B': 11
                    'Trend #C': 12
                    metric.label.check_id: 1
                    metric.label.checked_resource_id: 4
                    metric.label.checker_location: 2
                    resource.label.configuration_name: 5
                    resource.label.host: 9
                    resource.label.location: 6
                    resource.label.project_id: 0
                    resource.label.revision_name: 7
                    resource.label.service_name: 8
                    resource.type: 3
                orderByMode: manual
                renameByName:
                    'Trend #A': Status
                    'Trend #A (lastNotNull)': Status
                    'Trend #A (mean)': ""
                    'Trend #B': Latency
                    'Trend #B (mean)': Latency
                    'Trend #C': SSL Expiry
                    'Trend #C (lastNotNull)': SSL Expiry
                    'Value #A': Uptime Status
                    'Value #B': Latency (ms)
                    'Value #C': SSL Expiry (days)
                    metric.label.check_id: Check ID
                    metric.label.checked_resource_id: Check Resource ID
                    metric.label.checker_location: Location
                    resource.label.check_id: Check ID
                    resource.label.host: Host
                    resource.label.location: ""
                    resource.label.project_id: Project
                    resource.label.service_name: Service Name
                    resource.type: Check Resource Type
          type: table
    preload: false
    schemaVersion: 41
    tags:
        - Cloud Monitoring
        - GCP
        - Uptime
    templating:
        list:
            - allowCustomValue: false
              current:
                text:
                    - All
                value:
                    - $__all
              datasource:
                type: stackdriver
                uid: $datasource
              definition: ""
              description: GCP Project ID
              includeAll: true
              label: Projects
              multi: true
              name: project
              options: []
              query:
                "0": '{'
                "1": '"'
                "2": l
                "3": a
                "4": b
                "5": e
                "6": l
                "7": K
                "8": e
                "9": "y"
                "10": '"'
                "11": ':'
                "12": ' '
                "13": '"'
                "14": '"'
                "15": ','
                "16": ' '
                "17": '"'
                "18": p
                "19": r
                "20": o
                "21": j
                "22": e
                "23": c
                "24": t
                "25": "N"
                "26": a
                "27": m
                "28": e
                "29": '"'
                "30": ':'
                "31": ' '
                "32": '"'
                "33": d
                "34": u
                "35": p
                "36": l
                "37": o
                "38": '-'
                "39": l
                "40": o
                "41": g
                "42": s
                "43": '"'
                "44": ','
                "45": ' '
                "46": '"'
                "47": p
                "48": r
                "49": o
                "50": j
                "51": e
                "52": c
                "53": t
                "54": s
                "55": '"'
                "56": ':'
                "57": ' '
                "58": '['
                "59": '{'
                "60": '"'
                "61": l
                "62": a
                "63": b
                "64": e
                "65": l
                "66": '"'
                "67": ':'
                "68": ' '
                "69": '"'
                "70": d
                "71": u
                "72": p
                "73": l
                "74": o
                "75": '-'
                "76": l
                "77": o
                "78": g
                "79": s
                "80": '"'
                "81": ','
                "82": ' '
                "83": '"'
                "84": v
                "85": a
                "86": l
                "87": u
                "88": e
                "89": '"'
                "90": ':'
                "91": ' '
                "92": '"'
                "93": d
                "94": u
                "95": p
                "96": l
                "97": o
                "98": '-'
                "99": l
                "100": o
                "101": g
                "102": s
                "103": '"'
                "104": '}'
                "105": ','
                "106": ' '
                "107": '{'
                "108": '"'
                "109": l
                "110": a
                "111": b
                "112": e
                "113": l
                "114": '"'
                "115": ':'
                "116": ' '
                "117": '"'
                "118": c
                "119": x
                "120": '-'
                "121": a
                "122": p
                "123": p
                "124": '-'
                "125": f
                "126": o
                "127": x
                "128": b
                "129": a
                "130": c
                "131": k
                "132": s
                "133": t
                "134": a
                "135": g
                "136": e
                "137": '"'
                "138": ','
                "139": ' '
                "140": '"'
                "141": v
                "142": a
                "143": l
                "144": u
                "145": e
                "146": '"'
                "147": ':'
                "148": ' '
                "149": '"'
                "150": c
                "151": x
                "152": '-'
                "153": a
                "154": p
                "155": p
                "156": '-'
                "157": f
                "158": o
                "159": x
                "160": b
                "161": a
                "162": c
                "163": k
                "164": s
                "165": t
                "166": a
                "167": g
                "168": e
                "169": '"'
                "170": '}'
                "171": ','
                "172": ' '
                "173": '{'
                "174": '"'
                "175": l
                "176": a
                "177": b
                "178": e
                "179": l
                "180": '"'
                "181": ':'
                "182": ' '
                "183": '"'
                "184": c
                "185": x
                "186": '-'
                "187": a
                "188": p
                "189": p
                "190": '-'
                "191": "n"
                "192": u
                "193": t
                "194": a
                "195": "n"
                "196": i
                "197": x
                "198": c
                "199": a
                "200": m
                "201": p
                "202": u
                "203": s
                "204": '"'
                "205": ','
                "206": ' '
                "207": '"'
                "208": v
                "209": a
                "210": l
                "211": u
                "212": e
                "213": '"'
                "214": ':'
                "215": ' '
                "216": '"'
                "217": c
                "218": x
                "219": '-'
                "220": a
                "221": p
                "222": p
                "223": '-'
                "224": "n"
                "225": u
                "226": t
                "227": a
                "228": "n"
                "229": i
                "230": x
                "231": c
                "232": a
                "233": m
                "234": p
                "235": u
                "236": s
                "237": '"'
                "238": '}'
                "239": ','
                "240": ' '
                "241": '{'
                "242": '"'
                "243": l
                "244": a
                "245": b
                "246": e
                "247": l
                "248": '"'
                "249": ':'
                "250": ' '
                "251": '"'
                "252": c
                "253": x
                "254": '-'
                "255": a
                "256": p
                "257": p
                "258": '-'
                "259": a
                "260": d
                "261": o
                "262": b
                "263": e
                "264": '"'
                "265": ','
                "266": ' '
                "267": '"'
                "268": v
                "269": a
                "270": l
                "271": u
                "272": e
                "273": '"'
                "274": ':'
                "275": ' '
                "276": '"'
                "277": c
                "278": x
                "279": '-'
                "280": a
                "281": p
                "282": p
                "283": '-'
                "284": a
                "285": d
                "286": o
                "287": b
                "288": e
                "289": '"'
                "290": '}'
                "291": ']'
                "292": ','
                "293": ' '
                "294": '"'
                "295": s
                "296": e
                "297": l
                "298": e
                "299": c
                "300": t
                "301": e
                "302": d
                "303": Q
                "304": u
                "305": e
                "306": r
                "307": "y"
                "308": T
                "309": "y"
                "310": p
                "311": e
                "312": '"'
                "313": ':'
                "314": ' '
                "315": '"'
                "316": p
                "317": r
                "318": o
                "319": j
                "320": e
                "321": c
                "322": t
                "323": s
                "324": '"'
                "325": ','
                "326": ' '
                "327": '"'
                "328": r
                "329": e
                "330": f
                "331": I
                "332": d
                "333": '"'
                "334": ':'
                "335": ' '
                "336": '"'
                "337": C
                "338": l
                "339": o
                "340": u
                "341": d
                "342": M
                "343": o
                "344": "n"
                "345": i
                "346": t
                "347": o
                "348": r
                "349": i
                "350": "n"
                "351": g
                "352": V
                "353": a
                "354": r
                "355": i
                "356": a
                "357": b
                "358": l
                "359": e
                "360": Q
                "361": u
                "362": e
                "363": r
                "364": "y"
                "365": E
                "366": d
                "367": i
                "368": t
                "369": o
                "370": r
                "371": '-'
                "372": V
                "373": a
                "374": r
                "375": i
                "376": a
                "377": b
                "378": l
                "379": e
                "380": Q
                "381": u
                "382": e
                "383": r
                "384": "y"
                "385": '"'
                "386": '}'
                labelKey: ""
                loading: false
                projectName: duplo-logs
                projects:
                    - label: duplo-logs
                      value: duplo-logs
                    - label: cx-app-foxbackstage
                      value: cx-app-foxbackstage
                    - label: cx-app-nutanixcampus
                      value: cx-app-nutanixcampus
                    - label: cx-app-adobe
                      value: cx-app-adobe
                refId: CloudMonitoringVariableQueryEditor-VariableQuery
                selectedMetricType: actions.googleapis.com/smarthome_action/camerastream/first_frame_latencies
                selectedQueryType: projects
                selectedSLOService: ""
                selectedService: actions.googleapis.com
                sloServices: []
              refresh: 1
              regex: ^(?!.*duplo-logs).*
              type: query
    time:
        from: now-1h
        to: now
    timepicker: {}
    timezone: browser
    title: Uptime Checks Overview
    uid: uptime-checks-overview