namespace: integration-kubernetes
groups:
    - name: kubernetes-apps
      rules:
        - alert: KubePodCrashLooping
          expr: max_over_time(kube_pod_container_status_waiting_reason{job="integrations/kubernetes/kube-state-metrics",reason="CrashLoopBackOff"}[5m]) >= 1
          for: 15m
          labels:
            severity: warning
          annotations:
            description: 'Pod {{ $labels.namespace }}/{{ $labels.pod }} ({{ $labels.container }}) is in waiting state (reason: "CrashLoopBackOff") on cluster {{ $labels.cluster }}.'
            runbook_url: https://github.com/kubernetes-monitoring/kubernetes-mixin/tree/master/runbook.md#alert-name-kubepodcrashlooping
            summary: Pod is crash looping.
        - alert: KubePodNotReady
          expr: sum by (namespace, pod, cluster) (max by (namespace, pod, cluster) (kube_pod_status_phase{job="integrations/kubernetes/kube-state-metrics",phase=~"Pending|Unknown|Failed"}) * on (namespace, pod, cluster) group_left (owner_kind) topk by (namespace, pod, cluster) (1, max by (namespace, pod, owner_kind, cluster) (kube_pod_owner{owner_kind!="Job"}))) > 0
          for: 15m
          labels:
            severity: warning
          annotations:
            description: Pod {{ $labels.namespace }}/{{ $labels.pod }} has been in a non-ready state for longer than 15 minutes on cluster {{ $labels.cluster }}.
            runbook_url: https://github.com/kubernetes-monitoring/kubernetes-mixin/tree/master/runbook.md#alert-name-kubepodnotready
            summary: Pod has been in a non-ready state for more than 15 minutes.
        - alert: KubeDeploymentGenerationMismatch
          expr: kube_deployment_status_observed_generation{job="integrations/kubernetes/kube-state-metrics"} != kube_deployment_metadata_generation{job="integrations/kubernetes/kube-state-metrics"}
          for: 15m
          labels:
            severity: warning
          annotations:
            description: Deployment generation for {{ $labels.namespace }}/{{ $labels.deployment }} does not match, this indicates that the Deployment has failed but has not been rolled back on cluster {{ $labels.cluster }}.
            runbook_url: https://github.com/kubernetes-monitoring/kubernetes-mixin/tree/master/runbook.md#alert-name-kubedeploymentgenerationmismatch
            summary: Deployment generation mismatch due to possible roll-back
        - alert: KubeDeploymentReplicasMismatch
          expr: (kube_deployment_spec_replicas{job="integrations/kubernetes/kube-state-metrics"} > kube_deployment_status_replicas_available{job="integrations/kubernetes/kube-state-metrics"}) and (changes(kube_deployment_status_replicas_updated{job="integrations/kubernetes/kube-state-metrics"}[10m]) == 0)
          for: 15m
          labels:
            severity: warning
          annotations:
            description: Deployment {{ $labels.namespace }}/{{ $labels.deployment }} has not matched the expected number of replicas for longer than 15 minutes on cluster {{ $labels.cluster }}.
            runbook_url: https://github.com/kubernetes-monitoring/kubernetes-mixin/tree/master/runbook.md#alert-name-kubedeploymentreplicasmismatch
            summary: Deployment has not matched the expected number of replicas.
        - alert: KubeDeploymentRolloutStuck
          expr: kube_deployment_status_condition{condition="Progressing",job="integrations/kubernetes/kube-state-metrics",status="false"} != 0
          for: 15m
          labels:
            severity: warning
          annotations:
            description: Rollout of deployment {{ $labels.namespace }}/{{ $labels.deployment }} is not progressing for longer than 15 minutes on cluster {{ $labels.cluster }}.
            runbook_url: https://github.com/kubernetes-monitoring/kubernetes-mixin/tree/master/runbook.md#alert-name-kubedeploymentrolloutstuck
            summary: Deployment rollout is not progressing.
        - alert: KubeStatefulSetReplicasMismatch
          expr: (kube_statefulset_status_replicas_ready{job="integrations/kubernetes/kube-state-metrics"} != kube_statefulset_status_replicas{job="integrations/kubernetes/kube-state-metrics"}) and (changes(kube_statefulset_status_replicas_updated{job="integrations/kubernetes/kube-state-metrics"}[10m]) == 0)
          for: 15m
          labels:
            severity: warning
          annotations:
            description: StatefulSet {{ $labels.namespace }}/{{ $labels.statefulset }} has not matched the expected number of replicas for longer than 15 minutes on cluster {{ $labels.cluster }}.
            runbook_url: https://github.com/kubernetes-monitoring/kubernetes-mixin/tree/master/runbook.md#alert-name-kubestatefulsetreplicasmismatch
            summary: StatefulSet has not matched the expected number of replicas.
        - alert: KubeStatefulSetGenerationMismatch
          expr: kube_statefulset_status_observed_generation{job="integrations/kubernetes/kube-state-metrics"} != kube_statefulset_metadata_generation{job="integrations/kubernetes/kube-state-metrics"}
          for: 15m
          labels:
            severity: warning
          annotations:
            description: StatefulSet generation for {{ $labels.namespace }}/{{ $labels.statefulset }} does not match, this indicates that the StatefulSet has failed but has not been rolled back on cluster {{ $labels.cluster }}.
            runbook_url: https://github.com/kubernetes-monitoring/kubernetes-mixin/tree/master/runbook.md#alert-name-kubestatefulsetgenerationmismatch
            summary: StatefulSet generation mismatch due to possible roll-back
        - alert: KubeStatefulSetUpdateNotRolledOut
          expr: (max by (namespace, statefulset, job, cluster) (kube_statefulset_status_current_revision{job="integrations/kubernetes/kube-state-metrics"} unless kube_statefulset_status_update_revision{job="integrations/kubernetes/kube-state-metrics"}) * (kube_statefulset_replicas{job="integrations/kubernetes/kube-state-metrics"} != kube_statefulset_status_replicas_updated{job="integrations/kubernetes/kube-state-metrics"})) and (changes(kube_statefulset_status_replicas_updated{job="integrations/kubernetes/kube-state-metrics"}[5m]) == 0)
          for: 15m
          labels:
            severity: warning
          annotations:
            description: StatefulSet {{ $labels.namespace }}/{{ $labels.statefulset }} update has not been rolled out on cluster {{ $labels.cluster }}.
            runbook_url: https://github.com/kubernetes-monitoring/kubernetes-mixin/tree/master/runbook.md#alert-name-kubestatefulsetupdatenotrolledout
            summary: StatefulSet update has not been rolled out.
        - alert: KubeDaemonSetRolloutStuck
          expr: ((kube_daemonset_status_current_number_scheduled{job="integrations/kubernetes/kube-state-metrics"} != kube_daemonset_status_desired_number_scheduled{job="integrations/kubernetes/kube-state-metrics"}) or (kube_daemonset_status_number_misscheduled{job="integrations/kubernetes/kube-state-metrics"} != 0) or (kube_daemonset_status_updated_number_scheduled{job="integrations/kubernetes/kube-state-metrics"} != kube_daemonset_status_desired_number_scheduled{job="integrations/kubernetes/kube-state-metrics"}) or (kube_daemonset_status_number_available{job="integrations/kubernetes/kube-state-metrics"} != kube_daemonset_status_desired_number_scheduled{job="integrations/kubernetes/kube-state-metrics"})) and (changes(kube_daemonset_status_updated_number_scheduled{job="integrations/kubernetes/kube-state-metrics"}[5m]) == 0)
          for: 15m
          labels:
            severity: warning
          annotations:
            description: DaemonSet {{ $labels.namespace }}/{{ $labels.daemonset }} has not finished or progressed for at least 15m on cluster {{ $labels.cluster }}.
            runbook_url: https://github.com/kubernetes-monitoring/kubernetes-mixin/tree/master/runbook.md#alert-name-kubedaemonsetrolloutstuck
            summary: DaemonSet rollout is stuck.
        - alert: KubeContainerWaiting
          expr: kube_pod_container_status_waiting_reason{job="integrations/kubernetes/kube-state-metrics",reason!="CrashLoopBackOff"} > 0
          for: 1h
          labels:
            severity: warning
          annotations:
            description: 'pod/{{ $labels.pod }} in namespace {{ $labels.namespace }} on container {{ $labels.container}} has been in waiting state for longer than 1 hour. (reason: "{{ $labels.reason }}") on cluster {{ $labels.cluster }}.'
            runbook_url: https://github.com/kubernetes-monitoring/kubernetes-mixin/tree/master/runbook.md#alert-name-kubecontainerwaiting
            summary: Pod container waiting longer than 1 hour
        - alert: KubeDaemonSetNotScheduled
          expr: kube_daemonset_status_desired_number_scheduled{job="integrations/kubernetes/kube-state-metrics"} - kube_daemonset_status_current_number_scheduled{job="integrations/kubernetes/kube-state-metrics"} > 0
          for: 10m
          labels:
            severity: warning
          annotations:
            description: '{{ $value }} Pods of DaemonSet {{ $labels.namespace }}/{{ $labels.daemonset }} are not scheduled on cluster {{ $labels.cluster }}.'
            runbook_url: https://github.com/kubernetes-monitoring/kubernetes-mixin/tree/master/runbook.md#alert-name-kubedaemonsetnotscheduled
            summary: DaemonSet pods are not scheduled.
        - alert: KubeDaemonSetMisScheduled
          expr: kube_daemonset_status_number_misscheduled{job="integrations/kubernetes/kube-state-metrics"} > 0
          for: 15m
          labels:
            severity: warning
          annotations:
            description: '{{ $value }} Pods of DaemonSet {{ $labels.namespace }}/{{ $labels.daemonset }} are running where they are not supposed to run on cluster {{ $labels.cluster }}.'
            runbook_url: https://github.com/kubernetes-monitoring/kubernetes-mixin/tree/master/runbook.md#alert-name-kubedaemonsetmisscheduled
            summary: DaemonSet pods are misscheduled.
        - alert: KubeJobNotCompleted
          expr: time() - max by (namespace, job_name, cluster) (kube_job_status_start_time{job="integrations/kubernetes/kube-state-metrics"} and kube_job_status_active{job="integrations/kubernetes/kube-state-metrics"} > 0) > 43200
          labels:
            severity: warning
          annotations:
            description: Job {{ $labels.namespace }}/{{ $labels.job_name }} is taking more than {{ "43200" | humanizeDuration }} to complete on cluster {{ $labels.cluster }}.
            runbook_url: https://github.com/kubernetes-monitoring/kubernetes-mixin/tree/master/runbook.md#alert-name-kubejobnotcompleted
            summary: Job did not complete in time
        - alert: KubeJobFailed
          expr: kube_job_failed{job="integrations/kubernetes/kube-state-metrics"} > 0
          for: 15m
          labels:
            severity: warning
          annotations:
            description: Job {{ $labels.namespace }}/{{ $labels.job_name }} failed to complete. Removing failed job after investigation should clear this alert on cluster {{ $labels.cluster }}.
            runbook_url: https://github.com/kubernetes-monitoring/kubernetes-mixin/tree/master/runbook.md#alert-name-kubejobfailed
            summary: Job failed to complete.
        - alert: KubeHpaReplicasMismatch
          expr: (kube_horizontalpodautoscaler_status_desired_replicas{job="integrations/kubernetes/kube-state-metrics"} != kube_horizontalpodautoscaler_status_current_replicas{job="integrations/kubernetes/kube-state-metrics"}) and (kube_horizontalpodautoscaler_status_current_replicas{job="integrations/kubernetes/kube-state-metrics"} > kube_horizontalpodautoscaler_spec_min_replicas{job="integrations/kubernetes/kube-state-metrics"}) and (kube_horizontalpodautoscaler_status_current_replicas{job="integrations/kubernetes/kube-state-metrics"} < kube_horizontalpodautoscaler_spec_max_replicas{job="integrations/kubernetes/kube-state-metrics"}) and changes(kube_horizontalpodautoscaler_status_current_replicas{job="integrations/kubernetes/kube-state-metrics"}[15m]) == 0
          for: 15m
          labels:
            severity: warning
          annotations:
            description: HPA {{ $labels.namespace }}/{{ $labels.horizontalpodautoscaler  }} has not matched the desired number of replicas for longer than 15 minutes on cluster {{ $labels.cluster }}.
            runbook_url: https://github.com/kubernetes-monitoring/kubernetes-mixin/tree/master/runbook.md#alert-name-kubehpareplicasmismatch
            summary: HPA has not matched desired number of replicas.
        - alert: KubeHpaMaxedOut
          expr: kube_horizontalpodautoscaler_status_current_replicas{job="integrations/kubernetes/kube-state-metrics"} == kube_horizontalpodautoscaler_spec_max_replicas{job="integrations/kubernetes/kube-state-metrics"}
          for: 15m
          labels:
            severity: warning
          annotations:
            description: HPA {{ $labels.namespace }}/{{ $labels.horizontalpodautoscaler  }} has been running at max replicas for longer than 15 minutes on cluster {{ $labels.cluster }}.
            runbook_url: https://github.com/kubernetes-monitoring/kubernetes-mixin/tree/master/runbook.md#alert-name-kubehpamaxedout
            summary: HPA is running at max replicas
    - name: kubernetes-resources
      rules:
        - alert: KubeCPUOvercommit
          expr: sum by (cluster) (namespace_cpu:kube_pod_container_resource_requests:sum) - (sum by (cluster) (kube_node_status_allocatable{job="integrations/kubernetes/kube-state-metrics",resource="cpu"}) - max by (cluster) (kube_node_status_allocatable{job="integrations/kubernetes/kube-state-metrics",resource="cpu"})) > 0 and (sum by (cluster) (kube_node_status_allocatable{job="integrations/kubernetes/kube-state-metrics",resource="cpu"}) - max by (cluster) (kube_node_status_allocatable{job="integrations/kubernetes/kube-state-metrics",resource="cpu"})) > 0
          for: 10m
          labels:
            severity: warning
          annotations:
            description: Cluster {{ $labels.cluster }} has overcommitted CPU resource requests for Pods by {{ $value }} CPU shares and cannot tolerate node failure.
            runbook_url: https://github.com/kubernetes-monitoring/kubernetes-mixin/tree/master/runbook.md#alert-name-kubecpuovercommit
            summary: Cluster has overcommitted CPU resource requests.
        - alert: KubeMemoryOvercommit
          expr: sum by (cluster) (namespace_memory:kube_pod_container_resource_requests:sum) - (sum by (cluster) (kube_node_status_allocatable{job="integrations/kubernetes/kube-state-metrics",resource="memory"}) - max by (cluster) (kube_node_status_allocatable{job="integrations/kubernetes/kube-state-metrics",resource="memory"})) > 0 and (sum by (cluster) (kube_node_status_allocatable{job="integrations/kubernetes/kube-state-metrics",resource="memory"}) - max by (cluster) (kube_node_status_allocatable{job="integrations/kubernetes/kube-state-metrics",resource="memory"})) > 0
          for: 10m
          labels:
            severity: warning
          annotations:
            description: Cluster {{ $labels.cluster }} has overcommitted memory resource requests for Pods by {{ $value | humanize }} bytes and cannot tolerate node failure.
            runbook_url: https://github.com/kubernetes-monitoring/kubernetes-mixin/tree/master/runbook.md#alert-name-kubememoryovercommit
            summary: Cluster has overcommitted memory resource requests.
        - alert: KubeCPUQuotaOvercommit
          expr: sum by (cluster) (min without (resource) (kube_resourcequota{job="integrations/kubernetes/kube-state-metrics",resource=~"(cpu|requests.cpu)",type="hard"})) / sum by (cluster) (kube_node_status_allocatable{job="integrations/kubernetes/kube-state-metrics",resource="cpu"}) > 1.5
          for: 5m
          labels:
            severity: warning
          annotations:
            description: Cluster {{ $labels.cluster }}  has overcommitted CPU resource requests for Namespaces.
            runbook_url: https://github.com/kubernetes-monitoring/kubernetes-mixin/tree/master/runbook.md#alert-name-kubecpuquotaovercommit
            summary: Cluster has overcommitted CPU resource requests.
        - alert: KubeMemoryQuotaOvercommit
          expr: sum by (cluster) (min without (resource) (kube_resourcequota{job="integrations/kubernetes/kube-state-metrics",resource=~"(memory|requests.memory)",type="hard"})) / sum by (cluster) (kube_node_status_allocatable{job="integrations/kubernetes/kube-state-metrics",resource="memory"}) > 1.5
          for: 5m
          labels:
            severity: warning
          annotations:
            description: Cluster {{ $labels.cluster }}  has overcommitted memory resource requests for Namespaces.
            runbook_url: https://github.com/kubernetes-monitoring/kubernetes-mixin/tree/master/runbook.md#alert-name-kubememoryquotaovercommit
            summary: Cluster has overcommitted memory resource requests.
        - alert: KubeQuotaAlmostFull
          expr: kube_resourcequota{job="integrations/kubernetes/kube-state-metrics",type="used"} / ignoring (instance, job, type) (kube_resourcequota{job="integrations/kubernetes/kube-state-metrics",type="hard"} > 0) > 0.9 < 1
          for: 15m
          labels:
            severity: info
          annotations:
            description: Namespace {{ $labels.namespace }} is using {{ $value | humanizePercentage }} of its {{ $labels.resource }} quota on cluster {{ $labels.cluster }}.
            runbook_url: https://github.com/kubernetes-monitoring/kubernetes-mixin/tree/master/runbook.md#alert-name-kubequotaalmostfull
            summary: Namespace quota is going to be full.
        - alert: KubeQuotaFullyUsed
          expr: kube_resourcequota{job="integrations/kubernetes/kube-state-metrics",type="used"} / ignoring (instance, job, type) (kube_resourcequota{job="integrations/kubernetes/kube-state-metrics",type="hard"} > 0) == 1
          for: 15m
          labels:
            severity: info
          annotations:
            description: Namespace {{ $labels.namespace }} is using {{ $value | humanizePercentage }} of its {{ $labels.resource }} quota on cluster {{ $labels.cluster }}.
            runbook_url: https://github.com/kubernetes-monitoring/kubernetes-mixin/tree/master/runbook.md#alert-name-kubequotafullyused
            summary: Namespace quota is fully used.
        - alert: KubeQuotaExceeded
          expr: kube_resourcequota{job="integrations/kubernetes/kube-state-metrics",type="used"} / ignoring (instance, job, type) (kube_resourcequota{job="integrations/kubernetes/kube-state-metrics",type="hard"} > 0) > 1
          for: 15m
          labels:
            severity: warning
          annotations:
            description: Namespace {{ $labels.namespace }} is using {{ $value | humanizePercentage }} of its {{ $labels.resource }} quota on cluster {{ $labels.cluster }}.
            runbook_url: https://github.com/kubernetes-monitoring/kubernetes-mixin/tree/master/runbook.md#alert-name-kubequotaexceeded
            summary: Namespace quota has exceeded the limits.
        - alert: CPUThrottlingHigh
          expr: sum without (id, metrics_path, name, image, endpoint, job, node) (increase(container_cpu_cfs_throttled_periods_total{container!="",job="integrations/kubernetes/cadvisor"}[5m])) / sum without (id, metrics_path, name, image, endpoint, job, node) (increase(container_cpu_cfs_periods_total{job="integrations/kubernetes/cadvisor"}[5m])) > (25 / 100)
          for: 15m
          labels:
            severity: info
          annotations:
            description: '{{ $value | humanizePercentage }} throttling of CPU in namespace {{ $labels.namespace }} for container {{ $labels.container }} in pod {{ $labels.pod }} on cluster {{ $labels.cluster }}.'
            runbook_url: https://github.com/kubernetes-monitoring/kubernetes-mixin/tree/master/runbook.md#alert-name-cputhrottlinghigh
            summary: Processes experience elevated CPU throttling.
    - name: kubernetes-storage
      rules:
        - alert: KubePersistentVolumeFillingUp
          expr: (kubelet_volume_stats_available_bytes{job="integrations/kubernetes/kubelet"} / kubelet_volume_stats_capacity_bytes{job="integrations/kubernetes/kubelet"}) < 0.03 and kubelet_volume_stats_used_bytes{job="integrations/kubernetes/kubelet"} > 0 unless on (cluster, namespace, persistentvolumeclaim) kube_persistentvolumeclaim_access_mode{access_mode="ReadOnlyMany"} == 1 unless on (cluster, namespace, persistentvolumeclaim) kube_persistentvolumeclaim_labels{label_excluded_from_alerts="true"} == 1
          for: 1m
          labels:
            severity: critical
          annotations:
            description: The PersistentVolume claimed by {{ $labels.persistentvolumeclaim }} in Namespace {{ $labels.namespace }} {{ with $labels.cluster -}} on Cluster {{ . }} {{- end }} is only {{ $value | humanizePercentage }} free.
            runbook_url: https://github.com/kubernetes-monitoring/kubernetes-mixin/tree/master/runbook.md#alert-name-kubepersistentvolumefillingup
            summary: PersistentVolume is filling up.
        - alert: KubePersistentVolumeFillingUp
          expr: (kubelet_volume_stats_available_bytes{job="integrations/kubernetes/kubelet"} / kubelet_volume_stats_capacity_bytes{job="integrations/kubernetes/kubelet"}) < 0.15 and kubelet_volume_stats_used_bytes{job="integrations/kubernetes/kubelet"} > 0 and predict_linear(kubelet_volume_stats_available_bytes{job="integrations/kubernetes/kubelet"}[6h], 4 * 24 * 3600) < 0 unless on (cluster, namespace, persistentvolumeclaim) kube_persistentvolumeclaim_access_mode{access_mode="ReadOnlyMany"} == 1 unless on (cluster, namespace, persistentvolumeclaim) kube_persistentvolumeclaim_labels{label_excluded_from_alerts="true"} == 1
          for: 1h
          labels:
            severity: warning
          annotations:
            description: Based on recent sampling, the PersistentVolume claimed by {{ $labels.persistentvolumeclaim }} in Namespace {{ $labels.namespace }} {{ with $labels.cluster -}} on Cluster {{ . }} {{- end }} is expected to fill up within four days. Currently {{ $value | humanizePercentage }} is available.
            runbook_url: https://github.com/kubernetes-monitoring/kubernetes-mixin/tree/master/runbook.md#alert-name-kubepersistentvolumefillingup
            summary: PersistentVolume is filling up.
        - alert: KubePersistentVolumeInodesFillingUp
          expr: (kubelet_volume_stats_inodes_free{job="integrations/kubernetes/kubelet"} / kubelet_volume_stats_inodes{job="integrations/kubernetes/kubelet"}) < 0.03 and kubelet_volume_stats_inodes_used{job="integrations/kubernetes/kubelet"} > 0 unless on (cluster, namespace, persistentvolumeclaim) kube_persistentvolumeclaim_access_mode{access_mode="ReadOnlyMany"} == 1 unless on (cluster, namespace, persistentvolumeclaim) kube_persistentvolumeclaim_labels{label_excluded_from_alerts="true"} == 1
          for: 1m
          labels:
            severity: critical
          annotations:
            description: The PersistentVolume claimed by {{ $labels.persistentvolumeclaim }} in Namespace {{ $labels.namespace }} {{ with $labels.cluster -}} on Cluster {{ . }} {{- end }} only has {{ $value | humanizePercentage }} free inodes.
            runbook_url: https://github.com/kubernetes-monitoring/kubernetes-mixin/tree/master/runbook.md#alert-name-kubepersistentvolumeinodesfillingup
            summary: PersistentVolumeInodes are filling up.
        - alert: KubePersistentVolumeInodesFillingUp
          expr: (kubelet_volume_stats_inodes_free{job="integrations/kubernetes/kubelet"} / kubelet_volume_stats_inodes{job="integrations/kubernetes/kubelet"}) < 0.15 and kubelet_volume_stats_inodes_used{job="integrations/kubernetes/kubelet"} > 0 and predict_linear(kubelet_volume_stats_inodes_free{job="integrations/kubernetes/kubelet"}[6h], 4 * 24 * 3600) < 0 unless on (cluster, namespace, persistentvolumeclaim) kube_persistentvolumeclaim_access_mode{access_mode="ReadOnlyMany"} == 1 unless on (cluster, namespace, persistentvolumeclaim) kube_persistentvolumeclaim_labels{label_excluded_from_alerts="true"} == 1
          for: 1h
          labels:
            severity: warning
          annotations:
            description: Based on recent sampling, the PersistentVolume claimed by {{ $labels.persistentvolumeclaim }} in Namespace {{ $labels.namespace }} {{ with $labels.cluster -}} on Cluster {{ . }} {{- end }} is expected to run out of inodes within four days. Currently {{ $value | humanizePercentage }} of its inodes are free.
            runbook_url: https://github.com/kubernetes-monitoring/kubernetes-mixin/tree/master/runbook.md#alert-name-kubepersistentvolumeinodesfillingup
            summary: PersistentVolumeInodes are filling up.
        - alert: KubePersistentVolumeErrors
          expr: kube_persistentvolume_status_phase{job="integrations/kubernetes/kube-state-metrics",phase=~"Failed|Pending"} > 0
          for: 5m
          labels:
            severity: critical
          annotations:
            description: The persistent volume {{ $labels.persistentvolume }} {{ with $labels.cluster -}} on Cluster {{ . }} {{- end }} has status {{ $labels.phase }}.
            runbook_url: https://github.com/kubernetes-monitoring/kubernetes-mixin/tree/master/runbook.md#alert-name-kubepersistentvolumeerrors
            summary: PersistentVolume is having issues with provisioning.
