namespace: integration-kubernetes-system
groups:
    - name: kube-apiserver-availability.rules
      interval: 3m
      rules:
        - record: code_verb:apiserver_request_total:increase30d
          expr: avg_over_time(code_verb:apiserver_request_total:increase1h[30d]) * 24 * 30
        - record: code:apiserver_request_total:increase30d
          expr: sum by (cluster, code) (code_verb:apiserver_request_total:increase30d{verb=~"LIST|GET"})
          labels:
            verb: read
        - record: code:apiserver_request_total:increase30d
          expr: sum by (cluster, code) (code_verb:apiserver_request_total:increase30d{verb=~"POST|PUT|PATCH|DELETE"})
          labels:
            verb: write
        - record: cluster_verb_scope_le:apiserver_request_sli_duration_seconds_bucket:increase1h
          expr: sum by (cluster, verb, scope, le) (increase(apiserver_request_sli_duration_seconds_bucket[1h]))
        - record: cluster_verb_scope_le:apiserver_request_sli_duration_seconds_bucket:increase30d
          expr: sum by (cluster, verb, scope, le) (avg_over_time(cluster_verb_scope_le:apiserver_request_sli_duration_seconds_bucket:increase1h[30d]) * 24 * 30)
        - record: cluster_verb_scope:apiserver_request_sli_duration_seconds_count:increase1h
          expr: sum by (cluster, verb, scope) (cluster_verb_scope_le:apiserver_request_sli_duration_seconds_bucket:increase1h{le="+Inf"})
        - record: cluster_verb_scope:apiserver_request_sli_duration_seconds_count:increase30d
          expr: sum by (cluster, verb, scope) (cluster_verb_scope_le:apiserver_request_sli_duration_seconds_bucket:increase30d{le="+Inf"})
        - record: apiserver_request:availability30d
          expr: 1 - ((sum by (cluster) (cluster_verb_scope:apiserver_request_sli_duration_seconds_count:increase30d{verb=~"POST|PUT|PATCH|DELETE"}) - sum by (cluster) (cluster_verb_scope_le:apiserver_request_sli_duration_seconds_bucket:increase30d{le=~"1(\\.0)?",verb=~"POST|PUT|PATCH|DELETE"})) + (sum by (cluster) (cluster_verb_scope:apiserver_request_sli_duration_seconds_count:increase30d{verb=~"LIST|GET"}) - ((sum by (cluster) (cluster_verb_scope_le:apiserver_request_sli_duration_seconds_bucket:increase30d{le=~"1(\\.0)?",scope=~"resource|",verb=~"LIST|GET"}) or vector(0)) + sum by (cluster) (cluster_verb_scope_le:apiserver_request_sli_duration_seconds_bucket:increase30d{le=~"5(\\.0)?",scope="namespace",verb=~"LIST|GET"}) + sum by (cluster) (cluster_verb_scope_le:apiserver_request_sli_duration_seconds_bucket:increase30d{le=~"30(\\.0)?",scope="cluster",verb=~"LIST|GET"}))) + sum by (cluster) (code:apiserver_request_total:increase30d{code=~"5.."} or vector(0))) / sum by (cluster) (code:apiserver_request_total:increase30d)
          labels:
            verb: all
        - record: apiserver_request:availability30d
          expr: 1 - (sum by (cluster) (cluster_verb_scope:apiserver_request_sli_duration_seconds_count:increase30d{verb=~"LIST|GET"}) - ((sum by (cluster) (cluster_verb_scope_le:apiserver_request_sli_duration_seconds_bucket:increase30d{le=~"1(\\.0)?",scope=~"resource|",verb=~"LIST|GET"}) or vector(0)) + sum by (cluster) (cluster_verb_scope_le:apiserver_request_sli_duration_seconds_bucket:increase30d{le=~"5(\\.0)?",scope="namespace",verb=~"LIST|GET"}) + sum by (cluster) (cluster_verb_scope_le:apiserver_request_sli_duration_seconds_bucket:increase30d{le=~"30(\\.0)?",scope="cluster",verb=~"LIST|GET"})) + sum by (cluster) (code:apiserver_request_total:increase30d{code=~"5..",verb="read"} or vector(0))) / sum by (cluster) (code:apiserver_request_total:increase30d{verb="read"})
          labels:
            verb: read
        - record: apiserver_request:availability30d
          expr: 1 - ((sum by (cluster) (cluster_verb_scope:apiserver_request_sli_duration_seconds_count:increase30d{verb=~"POST|PUT|PATCH|DELETE"}) - sum by (cluster) (cluster_verb_scope_le:apiserver_request_sli_duration_seconds_bucket:increase30d{le=~"1(\\.0)?",verb=~"POST|PUT|PATCH|DELETE"})) + sum by (cluster) (code:apiserver_request_total:increase30d{code=~"5..",verb="write"} or vector(0))) / sum by (cluster) (code:apiserver_request_total:increase30d{verb="write"})
          labels:
            verb: write
        - record: code_resource:apiserver_request_total:rate5m
          expr: sum by (cluster, code, resource) (rate(apiserver_request_total{job="integrations/kubernetes/kube-apiserver",verb=~"LIST|GET"}[5m]))
          labels:
            verb: read
        - record: code_resource:apiserver_request_total:rate5m
          expr: sum by (cluster, code, resource) (rate(apiserver_request_total{job="integrations/kubernetes/kube-apiserver",verb=~"POST|PUT|PATCH|DELETE"}[5m]))
          labels:
            verb: write
        - record: code_verb:apiserver_request_total:increase1h
          expr: sum by (cluster, code, verb) (increase(apiserver_request_total{code=~"2..",job="integrations/kubernetes/kube-apiserver",verb=~"LIST|GET|POST|PUT|PATCH|DELETE"}[1h]))
        - record: code_verb:apiserver_request_total:increase1h
          expr: sum by (cluster, code, verb) (increase(apiserver_request_total{code=~"3..",job="integrations/kubernetes/kube-apiserver",verb=~"LIST|GET|POST|PUT|PATCH|DELETE"}[1h]))
        - record: code_verb:apiserver_request_total:increase1h
          expr: sum by (cluster, code, verb) (increase(apiserver_request_total{code=~"4..",job="integrations/kubernetes/kube-apiserver",verb=~"LIST|GET|POST|PUT|PATCH|DELETE"}[1h]))
        - record: code_verb:apiserver_request_total:increase1h
          expr: sum by (cluster, code, verb) (increase(apiserver_request_total{code=~"5..",job="integrations/kubernetes/kube-apiserver",verb=~"LIST|GET|POST|PUT|PATCH|DELETE"}[1h]))
    - name: kube-apiserver-burnrate.rules
      rules:
        - record: apiserver_request:burnrate1d
          expr: ((sum by (cluster) (rate(apiserver_request_sli_duration_seconds_count{job="integrations/kubernetes/kube-apiserver",subresource!~"proxy|attach|log|exec|portforward",verb=~"LIST|GET"}[1d])) - ((sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="integrations/kubernetes/kube-apiserver",le=~"1(\\.0)?",scope=~"resource|",subresource!~"proxy|attach|log|exec|portforward",verb=~"LIST|GET"}[1d])) or vector(0)) + sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="integrations/kubernetes/kube-apiserver",le=~"5(\\.0)?",scope="namespace",subresource!~"proxy|attach|log|exec|portforward",verb=~"LIST|GET"}[1d])) + sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="integrations/kubernetes/kube-apiserver",le=~"30(\\.0)?",scope="cluster",subresource!~"proxy|attach|log|exec|portforward",verb=~"LIST|GET"}[1d])))) + sum by (cluster) (rate(apiserver_request_total{code=~"5..",job="integrations/kubernetes/kube-apiserver",verb=~"LIST|GET"}[1d]))) / sum by (cluster) (rate(apiserver_request_total{job="integrations/kubernetes/kube-apiserver",verb=~"LIST|GET"}[1d]))
          labels:
            verb: read
        - record: apiserver_request:burnrate1h
          expr: ((sum by (cluster) (rate(apiserver_request_sli_duration_seconds_count{job="integrations/kubernetes/kube-apiserver",subresource!~"proxy|attach|log|exec|portforward",verb=~"LIST|GET"}[1h])) - ((sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="integrations/kubernetes/kube-apiserver",le=~"1(\\.0)?",scope=~"resource|",subresource!~"proxy|attach|log|exec|portforward",verb=~"LIST|GET"}[1h])) or vector(0)) + sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="integrations/kubernetes/kube-apiserver",le=~"5(\\.0)?",scope="namespace",subresource!~"proxy|attach|log|exec|portforward",verb=~"LIST|GET"}[1h])) + sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="integrations/kubernetes/kube-apiserver",le=~"30(\\.0)?",scope="cluster",subresource!~"proxy|attach|log|exec|portforward",verb=~"LIST|GET"}[1h])))) + sum by (cluster) (rate(apiserver_request_total{code=~"5..",job="integrations/kubernetes/kube-apiserver",verb=~"LIST|GET"}[1h]))) / sum by (cluster) (rate(apiserver_request_total{job="integrations/kubernetes/kube-apiserver",verb=~"LIST|GET"}[1h]))
          labels:
            verb: read
        - record: apiserver_request:burnrate2h
          expr: ((sum by (cluster) (rate(apiserver_request_sli_duration_seconds_count{job="integrations/kubernetes/kube-apiserver",subresource!~"proxy|attach|log|exec|portforward",verb=~"LIST|GET"}[2h])) - ((sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="integrations/kubernetes/kube-apiserver",le=~"1(\\.0)?",scope=~"resource|",subresource!~"proxy|attach|log|exec|portforward",verb=~"LIST|GET"}[2h])) or vector(0)) + sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="integrations/kubernetes/kube-apiserver",le=~"5(\\.0)?",scope="namespace",subresource!~"proxy|attach|log|exec|portforward",verb=~"LIST|GET"}[2h])) + sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="integrations/kubernetes/kube-apiserver",le=~"30(\\.0)?",scope="cluster",subresource!~"proxy|attach|log|exec|portforward",verb=~"LIST|GET"}[2h])))) + sum by (cluster) (rate(apiserver_request_total{code=~"5..",job="integrations/kubernetes/kube-apiserver",verb=~"LIST|GET"}[2h]))) / sum by (cluster) (rate(apiserver_request_total{job="integrations/kubernetes/kube-apiserver",verb=~"LIST|GET"}[2h]))
          labels:
            verb: read
        - record: apiserver_request:burnrate30m
          expr: ((sum by (cluster) (rate(apiserver_request_sli_duration_seconds_count{job="integrations/kubernetes/kube-apiserver",subresource!~"proxy|attach|log|exec|portforward",verb=~"LIST|GET"}[30m])) - ((sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="integrations/kubernetes/kube-apiserver",le=~"1(\\.0)?",scope=~"resource|",subresource!~"proxy|attach|log|exec|portforward",verb=~"LIST|GET"}[30m])) or vector(0)) + sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="integrations/kubernetes/kube-apiserver",le=~"5(\\.0)?",scope="namespace",subresource!~"proxy|attach|log|exec|portforward",verb=~"LIST|GET"}[30m])) + sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="integrations/kubernetes/kube-apiserver",le=~"30(\\.0)?",scope="cluster",subresource!~"proxy|attach|log|exec|portforward",verb=~"LIST|GET"}[30m])))) + sum by (cluster) (rate(apiserver_request_total{code=~"5..",job="integrations/kubernetes/kube-apiserver",verb=~"LIST|GET"}[30m]))) / sum by (cluster) (rate(apiserver_request_total{job="integrations/kubernetes/kube-apiserver",verb=~"LIST|GET"}[30m]))
          labels:
            verb: read
        - record: apiserver_request:burnrate3d
          expr: ((sum by (cluster) (rate(apiserver_request_sli_duration_seconds_count{job="integrations/kubernetes/kube-apiserver",subresource!~"proxy|attach|log|exec|portforward",verb=~"LIST|GET"}[3d])) - ((sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="integrations/kubernetes/kube-apiserver",le=~"1(\\.0)?",scope=~"resource|",subresource!~"proxy|attach|log|exec|portforward",verb=~"LIST|GET"}[3d])) or vector(0)) + sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="integrations/kubernetes/kube-apiserver",le=~"5(\\.0)?",scope="namespace",subresource!~"proxy|attach|log|exec|portforward",verb=~"LIST|GET"}[3d])) + sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="integrations/kubernetes/kube-apiserver",le=~"30(\\.0)?",scope="cluster",subresource!~"proxy|attach|log|exec|portforward",verb=~"LIST|GET"}[3d])))) + sum by (cluster) (rate(apiserver_request_total{code=~"5..",job="integrations/kubernetes/kube-apiserver",verb=~"LIST|GET"}[3d]))) / sum by (cluster) (rate(apiserver_request_total{job="integrations/kubernetes/kube-apiserver",verb=~"LIST|GET"}[3d]))
          labels:
            verb: read
        - record: apiserver_request:burnrate5m
          expr: ((sum by (cluster) (rate(apiserver_request_sli_duration_seconds_count{job="integrations/kubernetes/kube-apiserver",subresource!~"proxy|attach|log|exec|portforward",verb=~"LIST|GET"}[5m])) - ((sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="integrations/kubernetes/kube-apiserver",le=~"1(\\.0)?",scope=~"resource|",subresource!~"proxy|attach|log|exec|portforward",verb=~"LIST|GET"}[5m])) or vector(0)) + sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="integrations/kubernetes/kube-apiserver",le=~"5(\\.0)?",scope="namespace",subresource!~"proxy|attach|log|exec|portforward",verb=~"LIST|GET"}[5m])) + sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="integrations/kubernetes/kube-apiserver",le=~"30(\\.0)?",scope="cluster",subresource!~"proxy|attach|log|exec|portforward",verb=~"LIST|GET"}[5m])))) + sum by (cluster) (rate(apiserver_request_total{code=~"5..",job="integrations/kubernetes/kube-apiserver",verb=~"LIST|GET"}[5m]))) / sum by (cluster) (rate(apiserver_request_total{job="integrations/kubernetes/kube-apiserver",verb=~"LIST|GET"}[5m]))
          labels:
            verb: read
        - record: apiserver_request:burnrate6h
          expr: ((sum by (cluster) (rate(apiserver_request_sli_duration_seconds_count{job="integrations/kubernetes/kube-apiserver",subresource!~"proxy|attach|log|exec|portforward",verb=~"LIST|GET"}[6h])) - ((sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="integrations/kubernetes/kube-apiserver",le=~"1(\\.0)?",scope=~"resource|",subresource!~"proxy|attach|log|exec|portforward",verb=~"LIST|GET"}[6h])) or vector(0)) + sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="integrations/kubernetes/kube-apiserver",le=~"5(\\.0)?",scope="namespace",subresource!~"proxy|attach|log|exec|portforward",verb=~"LIST|GET"}[6h])) + sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="integrations/kubernetes/kube-apiserver",le=~"30(\\.0)?",scope="cluster",subresource!~"proxy|attach|log|exec|portforward",verb=~"LIST|GET"}[6h])))) + sum by (cluster) (rate(apiserver_request_total{code=~"5..",job="integrations/kubernetes/kube-apiserver",verb=~"LIST|GET"}[6h]))) / sum by (cluster) (rate(apiserver_request_total{job="integrations/kubernetes/kube-apiserver",verb=~"LIST|GET"}[6h]))
          labels:
            verb: read
        - record: apiserver_request:burnrate1d
          expr: ((sum by (cluster) (rate(apiserver_request_sli_duration_seconds_count{job="integrations/kubernetes/kube-apiserver",subresource!~"proxy|attach|log|exec|portforward",verb=~"POST|PUT|PATCH|DELETE"}[1d])) - sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="integrations/kubernetes/kube-apiserver",le=~"1(\\.0)?",subresource!~"proxy|attach|log|exec|portforward",verb=~"POST|PUT|PATCH|DELETE"}[1d]))) + sum by (cluster) (rate(apiserver_request_total{code=~"5..",job="integrations/kubernetes/kube-apiserver",verb=~"POST|PUT|PATCH|DELETE"}[1d]))) / sum by (cluster) (rate(apiserver_request_total{job="integrations/kubernetes/kube-apiserver",verb=~"POST|PUT|PATCH|DELETE"}[1d]))
          labels:
            verb: write
        - record: apiserver_request:burnrate1h
          expr: ((sum by (cluster) (rate(apiserver_request_sli_duration_seconds_count{job="integrations/kubernetes/kube-apiserver",subresource!~"proxy|attach|log|exec|portforward",verb=~"POST|PUT|PATCH|DELETE"}[1h])) - sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="integrations/kubernetes/kube-apiserver",le=~"1(\\.0)?",subresource!~"proxy|attach|log|exec|portforward",verb=~"POST|PUT|PATCH|DELETE"}[1h]))) + sum by (cluster) (rate(apiserver_request_total{code=~"5..",job="integrations/kubernetes/kube-apiserver",verb=~"POST|PUT|PATCH|DELETE"}[1h]))) / sum by (cluster) (rate(apiserver_request_total{job="integrations/kubernetes/kube-apiserver",verb=~"POST|PUT|PATCH|DELETE"}[1h]))
          labels:
            verb: write
        - record: apiserver_request:burnrate2h
          expr: ((sum by (cluster) (rate(apiserver_request_sli_duration_seconds_count{job="integrations/kubernetes/kube-apiserver",subresource!~"proxy|attach|log|exec|portforward",verb=~"POST|PUT|PATCH|DELETE"}[2h])) - sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="integrations/kubernetes/kube-apiserver",le=~"1(\\.0)?",subresource!~"proxy|attach|log|exec|portforward",verb=~"POST|PUT|PATCH|DELETE"}[2h]))) + sum by (cluster) (rate(apiserver_request_total{code=~"5..",job="integrations/kubernetes/kube-apiserver",verb=~"POST|PUT|PATCH|DELETE"}[2h]))) / sum by (cluster) (rate(apiserver_request_total{job="integrations/kubernetes/kube-apiserver",verb=~"POST|PUT|PATCH|DELETE"}[2h]))
          labels:
            verb: write
        - record: apiserver_request:burnrate30m
          expr: ((sum by (cluster) (rate(apiserver_request_sli_duration_seconds_count{job="integrations/kubernetes/kube-apiserver",subresource!~"proxy|attach|log|exec|portforward",verb=~"POST|PUT|PATCH|DELETE"}[30m])) - sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="integrations/kubernetes/kube-apiserver",le=~"1(\\.0)?",subresource!~"proxy|attach|log|exec|portforward",verb=~"POST|PUT|PATCH|DELETE"}[30m]))) + sum by (cluster) (rate(apiserver_request_total{code=~"5..",job="integrations/kubernetes/kube-apiserver",verb=~"POST|PUT|PATCH|DELETE"}[30m]))) / sum by (cluster) (rate(apiserver_request_total{job="integrations/kubernetes/kube-apiserver",verb=~"POST|PUT|PATCH|DELETE"}[30m]))
          labels:
            verb: write
        - record: apiserver_request:burnrate3d
          expr: ((sum by (cluster) (rate(apiserver_request_sli_duration_seconds_count{job="integrations/kubernetes/kube-apiserver",subresource!~"proxy|attach|log|exec|portforward",verb=~"POST|PUT|PATCH|DELETE"}[3d])) - sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="integrations/kubernetes/kube-apiserver",le=~"1(\\.0)?",subresource!~"proxy|attach|log|exec|portforward",verb=~"POST|PUT|PATCH|DELETE"}[3d]))) + sum by (cluster) (rate(apiserver_request_total{code=~"5..",job="integrations/kubernetes/kube-apiserver",verb=~"POST|PUT|PATCH|DELETE"}[3d]))) / sum by (cluster) (rate(apiserver_request_total{job="integrations/kubernetes/kube-apiserver",verb=~"POST|PUT|PATCH|DELETE"}[3d]))
          labels:
            verb: write
        - record: apiserver_request:burnrate5m
          expr: ((sum by (cluster) (rate(apiserver_request_sli_duration_seconds_count{job="integrations/kubernetes/kube-apiserver",subresource!~"proxy|attach|log|exec|portforward",verb=~"POST|PUT|PATCH|DELETE"}[5m])) - sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="integrations/kubernetes/kube-apiserver",le=~"1(\\.0)?",subresource!~"proxy|attach|log|exec|portforward",verb=~"POST|PUT|PATCH|DELETE"}[5m]))) + sum by (cluster) (rate(apiserver_request_total{code=~"5..",job="integrations/kubernetes/kube-apiserver",verb=~"POST|PUT|PATCH|DELETE"}[5m]))) / sum by (cluster) (rate(apiserver_request_total{job="integrations/kubernetes/kube-apiserver",verb=~"POST|PUT|PATCH|DELETE"}[5m]))
          labels:
            verb: write
        - record: apiserver_request:burnrate6h
          expr: ((sum by (cluster) (rate(apiserver_request_sli_duration_seconds_count{job="integrations/kubernetes/kube-apiserver",subresource!~"proxy|attach|log|exec|portforward",verb=~"POST|PUT|PATCH|DELETE"}[6h])) - sum by (cluster) (rate(apiserver_request_sli_duration_seconds_bucket{job="integrations/kubernetes/kube-apiserver",le=~"1(\\.0)?",subresource!~"proxy|attach|log|exec|portforward",verb=~"POST|PUT|PATCH|DELETE"}[6h]))) + sum by (cluster) (rate(apiserver_request_total{code=~"5..",job="integrations/kubernetes/kube-apiserver",verb=~"POST|PUT|PATCH|DELETE"}[6h]))) / sum by (cluster) (rate(apiserver_request_total{job="integrations/kubernetes/kube-apiserver",verb=~"POST|PUT|PATCH|DELETE"}[6h]))
          labels:
            verb: write
    - name: kube-apiserver-histogram.rules
      rules:
        - record: cluster_quantile:apiserver_request_sli_duration_seconds:histogram_quantile
          expr: histogram_quantile(0.99, sum by (cluster, le, resource) (rate(apiserver_request_sli_duration_seconds_bucket{job="integrations/kubernetes/kube-apiserver",subresource!~"proxy|attach|log|exec|portforward",verb=~"LIST|GET"}[5m]))) > 0
          labels:
            quantile: "0.99"
            verb: read
        - record: cluster_quantile:apiserver_request_sli_duration_seconds:histogram_quantile
          expr: histogram_quantile(0.99, sum by (cluster, le, resource) (rate(apiserver_request_sli_duration_seconds_bucket{job="integrations/kubernetes/kube-apiserver",subresource!~"proxy|attach|log|exec|portforward",verb=~"POST|PUT|PATCH|DELETE"}[5m]))) > 0
          labels:
            quantile: "0.99"
            verb: write
    - name: kube-scheduler.rules
      rules:
        - record: cluster_quantile:scheduler_e2e_scheduling_duration_seconds:histogram_quantile
          expr: histogram_quantile(0.99, sum without (instance, pod) (rate(scheduler_e2e_scheduling_duration_seconds_bucket{job="integrations/kubernetes/kube-scheduler"}[5m])))
          labels:
            quantile: "0.99"
        - record: cluster_quantile:scheduler_scheduling_algorithm_duration_seconds:histogram_quantile
          expr: histogram_quantile(0.99, sum without (instance, pod) (rate(scheduler_scheduling_algorithm_duration_seconds_bucket{job="integrations/kubernetes/kube-scheduler"}[5m])))
          labels:
            quantile: "0.99"
        - record: cluster_quantile:scheduler_binding_duration_seconds:histogram_quantile
          expr: histogram_quantile(0.99, sum without (instance, pod) (rate(scheduler_binding_duration_seconds_bucket{job="integrations/kubernetes/kube-scheduler"}[5m])))
          labels:
            quantile: "0.99"
        - record: cluster_quantile:scheduler_e2e_scheduling_duration_seconds:histogram_quantile
          expr: histogram_quantile(0.9, sum without (instance, pod) (rate(scheduler_e2e_scheduling_duration_seconds_bucket{job="integrations/kubernetes/kube-scheduler"}[5m])))
          labels:
            quantile: "0.9"
        - record: cluster_quantile:scheduler_scheduling_algorithm_duration_seconds:histogram_quantile
          expr: histogram_quantile(0.9, sum without (instance, pod) (rate(scheduler_scheduling_algorithm_duration_seconds_bucket{job="integrations/kubernetes/kube-scheduler"}[5m])))
          labels:
            quantile: "0.9"
        - record: cluster_quantile:scheduler_binding_duration_seconds:histogram_quantile
          expr: histogram_quantile(0.9, sum without (instance, pod) (rate(scheduler_binding_duration_seconds_bucket{job="integrations/kubernetes/kube-scheduler"}[5m])))
          labels:
            quantile: "0.9"
        - record: cluster_quantile:scheduler_e2e_scheduling_duration_seconds:histogram_quantile
          expr: histogram_quantile(0.5, sum without (instance, pod) (rate(scheduler_e2e_scheduling_duration_seconds_bucket{job="integrations/kubernetes/kube-scheduler"}[5m])))
          labels:
            quantile: "0.5"
        - record: cluster_quantile:scheduler_scheduling_algorithm_duration_seconds:histogram_quantile
          expr: histogram_quantile(0.5, sum without (instance, pod) (rate(scheduler_scheduling_algorithm_duration_seconds_bucket{job="integrations/kubernetes/kube-scheduler"}[5m])))
          labels:
            quantile: "0.5"
        - record: cluster_quantile:scheduler_binding_duration_seconds:histogram_quantile
          expr: histogram_quantile(0.5, sum without (instance, pod) (rate(scheduler_binding_duration_seconds_bucket{job="integrations/kubernetes/kube-scheduler"}[5m])))
          labels:
            quantile: "0.5"
    - name: kubelet.rules
      rules:
        - record: node_quantile:kubelet_pleg_relist_duration_seconds:histogram_quantile
          expr: histogram_quantile(0.99, sum by (cluster, instance, le) (rate(kubelet_pleg_relist_duration_seconds_bucket{job="integrations/kubernetes/kubelet"}[5m])) * on (cluster, instance) group_left (node) kubelet_node_name{job="integrations/kubernetes/kubelet"})
          labels:
            quantile: "0.99"
        - record: node_quantile:kubelet_pleg_relist_duration_seconds:histogram_quantile
          expr: histogram_quantile(0.9, sum by (cluster, instance, le) (rate(kubelet_pleg_relist_duration_seconds_bucket{job="integrations/kubernetes/kubelet"}[5m])) * on (cluster, instance) group_left (node) kubelet_node_name{job="integrations/kubernetes/kubelet"})
          labels:
            quantile: "0.9"
        - record: node_quantile:kubelet_pleg_relist_duration_seconds:histogram_quantile
          expr: histogram_quantile(0.5, sum by (cluster, instance, le) (rate(kubelet_pleg_relist_duration_seconds_bucket{job="integrations/kubernetes/kubelet"}[5m])) * on (cluster, instance) group_left (node) kubelet_node_name{job="integrations/kubernetes/kubelet"})
          labels:
            quantile: "0.5"
