## Run From Powershell

Set-Location -Path $env:TEMP;
Invoke-WebRequest -Uri "https://raw.githubusercontent.com/duplocloud/opentelemetry-release/refs/heads/main/alloy/windows/script/install-windows-alloy.ps1" -OutFile "install-windows-alloy.ps1";
$duploLoggingPaths = '[{\"__path__\" = \"C:\\var\\log\\*.log\", \"__address__\" = \"localhost\", \"job\" = \"integrations/iis\" or \"integrations/windows_exporter\", \"site\" = \"<your-site1-name>\"}]';
powershell -ExecutionPolicy Bypass -File "./install-windows-alloy.ps1" -DUPLO_LOGGING_PATHS $duploLoggingPaths -DUPLO_METRICS_URL "https://<metrics_url>/api/v1/push" -DUPLO_LOGGING_URL "https://<logs_url>/loki/api/v1/push" -DUPLO_TENANT_NAME "duplo tenant name" -HOSTNAME "windows hostname";

Set-Location -Path $env:TEMP;
Invoke-WebRequest -Uri "https://raw.githubusercontent.com/duplocloud/opentelemetry-release/refs/heads/main/alloy/windows/script/install-windows-exporter.ps1" -OutFile "install-windows-exporter.ps1";
powershell -ExecutionPolicy Bypass -File "./install-windows-exporter.ps1";


## Run From CMD

cd "%TEMP%" && powershell -c Invoke-WebRequest "https://raw.githubusercontent.com/duplocloud/opentelemetry-release/refs/heads/main/alloy/windows/script/install-windows-alloy.ps1" -OutFile "install-windows-alloy.ps1" && powershell -executionpolicy Bypass -File ".\install-windows-alloy.ps1" -DUPLO_LOGGING_PATHS $duploLoggingPaths -DUPLO_METRICS_URL "https://<metrics_url>/api/v1/push" -DUPLO_LOGGING_URL "https://<logs_url>/loki/api/v1/push" -DUPLO_TENANT_NAME "duplo tenant name" -HOSTNAME "windows hostname""

cd "%TEMP%" && powershell -c Invoke-WebRequest "https://raw.githubusercontent.com/duplocloud/opentelemetry-release/refs/heads/main/alloy/windows/script/install-windows-exporter.ps1" -OutFile "install-windows-exporter.ps1" && powershell -executionpolicy Bypass -File ".\install-windows-exporter.ps1"
